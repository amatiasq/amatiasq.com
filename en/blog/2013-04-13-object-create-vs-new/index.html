<!DOCTYPE html><html lang="en"><head><meta charSet="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Object.create vs new (ðŸ‡ªðŸ‡¸ only) | A. MatÃ­as Quezada</title><style> *, *::before, *::after { box-sizing: border-box; } ul, ol { padding: 0; } body, h1, h2, h3, h4, p, ul, ol, li, figure, figcaption, blockquote, dl, dd { margin: 0; } body { min-height: 100vh; scroll-behavior: smooth; text-rendering: optimizeSpeed; line-height: 1.5; } ul, ol { list-style: none; } .md ul, .md ol { list-style: initial; padding: revert; } a:not([class]) { text-decoration-skip-ink: auto; } img { max-width: 100%; display: block; } article > * + * { margin-top: 1em; } input, button, textarea, select { font: inherit; } @media (prefers-reduced-motion: reduce) { * { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; scroll-behavior: auto !important; } } </style><style> @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=Lato:ital,wght@1,400;1,700&family=Montserrat:wght@400;700&display=swap'); :root { background-color: #263238; color: #FDFBF8; font-family: Lato, sans-serif; font-size: 18px; --border-color: #586369; } header, h1, h2, h3, h4, h5, h6 { font-family: Montserrat, sans-serif; } a { color: #EFE751; } .md p { margin: 20px 0; text-align: justify; } code { font-family: Fira Code, monospace; } .md .code-block { display: block; font-family: Fira Code, monospace; width: var(--available-width); padding-bottom: 10px; } svg { fill: #FDFBF8; } </style><style> [class*=shj-lang-]{white-space:pre;margin:10px 0;border-radius:10px;padding:30px 20px;background:white;color:#112;box-shadow:0 0 5px #0001;text-shadow:none;font: 18px Consolas,Courier New,Monaco,Andale Mono,Ubuntu Mono,monospace;line-height:24px;box-sizing:border-box;max-width:min(100%,100vw)} .shj-inline{margin:0;padding:2px 5px;display:inline-block;border-radius:5px} [class*=shj-lang-]::selection, [class*=shj-lang-] ::selection{background:#bdf5} [class*=shj-lang-]>div{display:flex;overflow:auto} [class*=shj-lang-]>div :last-child{flex:1;outline:none} .shj-numbers{padding-left:5px;counter-reset:line} .shj-numbers div{padding-right:5px} .shj-numbers div:before{color:#999;display:block;content:counter(line);opacity:.5;text-align:right;margin-right:5px;counter-increment:line} .shj-syn-cmnt{font-style:italic} .shj-syn-err, .shj-syn-kwd{color:#e16} .shj-syn-num, .shj-syn-class{color:#f60} .shj-numbers, .shj-syn-cmnt{color:#999} .shj-syn-insert, .shj-syn-str{color:#7d8} .shj-syn-bool{color:#3bf} .shj-syn-type, .shj-syn-oper{color:#5af} .shj-syn-section, .shj-syn-func{color:#84f} .shj-syn-deleted, .shj-syn-var{color:#f44} .shj-oneline{padding:12px 10px} .shj-lang-http.shj-oneline .shj-syn-kwd{background:#25f;color:#fff;padding:5px 7px;border-radius:5px} .shj-multiline.shj-mode-header{padding:20px} .shj-multiline.shj-mode-header:before{content:attr(data-lang);color:#58f;display:block;padding:10px 20px;background:#58f3;border-radius:5px;margin-bottom:20px} [class*=shj-lang-]{color:#abb2bf;background:#161b22} [class*=shj-lang-]:before{color:#6f9aff} .shj-syn-deleted, .shj-syn-err, .shj-syn-var{color:#e06c75} .shj-syn-section, .shj-syn-oper, .shj-syn-kwd{color:#c678dd} .shj-syn-class{color:#e5c07b} .shj-numbers, .shj-syn-cmnt{color:#76839a} .shj-syn-insert{color:#98c379} .shj-syn-type{color:#56b6c2} .shj-syn-num, .shj-syn-bool{color:#d19a66} .shj-syn-str, .shj-syn-func{color:#61afef} </style><style>.css-zi0qjt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}
.css-1p4f3y5{display:grid;padding-top:20px;gap:12px;}
.css-2nd93p{padding:20px 0;margin-bottom:20px;background-color:#1B2225;color:#FDFBF8;border-bottom:2px solid #586369;}@media (min-width: 769px){.css-2nd93p{position:-webkit-sticky;position:sticky;top:0;z-index:1;}}
.css-17rdaxl{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media (min-width: 769px){.css-17rdaxl{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}
.css-eexrvx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:12px;}.css-eexrvx a{color:#EFE751;-webkit-text-decoration:none;text-decoration:none;margin-left:12px;border-bottom:1px solid transparent;-webkit-transform:translate(0px, 0px);-moz-transform:translate(0px, 0px);-ms-transform:translate(0px, 0px);transform:translate(0px, 0px);}.css-eexrvx a.parent{border-bottom:1px solid #586369;}.css-eexrvx a:hover{border-bottom:1px solid #EFE751;-webkit-transition:-webkit-transform 1s ease;transition:transform 1s ease;-webkit-transform:translate(0px, -3px);-moz-transform:translate(0px, -3px);-ms-transform:translate(0px, -3px);transform:translate(0px, -3px);}
.css-18wymod{--container-side-gap:1rem;--container-width:40rem;--container-sides-gap:calc(var(--container-side-gap) * 2);--available-width:min(
      calc(100vw - var(--container-sides-gap)),
      calc(var(--container-width) - var(--container-sides-gap))
    );max-width:var(--container-width);padding-left:var(--container-side-gap);padding-right:var(--container-side-gap);margin-left:auto;margin-right:auto;}@media (min-width: 769px){.css-18wymod{--container-width:50rem;--container-side-gap:3rem;}}@media (min-width: 1200px){.css-18wymod{--container-width:60rem;}}
.css-hlqr5i{font-size:24px;-webkit-text-decoration:none;text-decoration:none;color:#FFFFFF;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:baseline;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;letter-spacing:1px;}.css-hlqr5i abbr{display:inline-block;width:0.8em;margin-right:0.35em;overflow:hidden;-webkit-transition:width 0.3s ease;transition:width 0.3s ease;}.css-hlqr5i:hover abbr{width:3.75em;}
.css-187qu0u{font-family:Montserrat,sans-serif;font-weight:700;font-size:32px;}
.css-a9renj{opacity:0.8;font-family:Fira Code,monospace;color:#FDFBF8;}</style></head><body class=""><header class="css-2nd93p "><div class="css-17rdaxl css-18wymod"><h2><a href="../../.." class="css-hlqr5i"><abbr>Adrian</abbr> MatÃ­as Quezada</a></h2><nav class="css-eexrvx"><a href="../../../blog" class="">Blog</a><a href="../../../career" class="">Career</a><a href="../../../projects" class="">Projects</a><a href="../../../es/blog/2013-04-13-object-create-vs-new" class="">ðŸ‡ªðŸ‡¸</a></nav></div></header><div class="css-1p4f3y5 css-18wymod"><div class="css-zi0qjt"><h2 class="undefined css-187qu0u">Object.create vs new (ðŸ‡ªðŸ‡¸ only)</h2><time class="css-a9renj " dateTime="04/13/2013">Apr 13, 2013</time></div><article><div class="md"><blockquote>
<p>ActualizaciÃ³n 19/3/2014: Finalmente he entendido la utilidad de reemplazar <code>new</code>, se puede ver <a href="http://blog.amatiasq.com/2014/03/type-new/">aquÃ­</a></p>
</blockquote>
<p>JotaEseros! Tengo un dilema existencial que me impide dormir.</p>
<p>Hasta donde sÃ© los constructores hacen mÃ¡s o menos esto</p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">function</span> <span class="shj-syn-func">fakeNew</span>(<span class="shj-syn-class">Ctor</span>) {
  <span class="shj-syn-kwd">var</span> instance <span class="shj-syn-oper">=</span> <span class="shj-syn-class">Object</span><span class="shj-syn-oper">.</span><span class="shj-syn-func">create</span>(<span class="shj-syn-class">Ctor</span><span class="shj-syn-oper">.</span>prototype);
  instance<span class="shj-syn-oper">.</span><span class="shj-syn-kwd">constructor</span>();
  <span class="shj-syn-kwd">return</span> instance;
}</div></div>
</code>
<!-- end extract -->
<p>Todo empezÃ³ cuando quise hacer polyfill de Object.create(), asÃ­ podrÃ­a crear objectos sin usar <code>new</code>, decidÃ­ usar la versiÃ³n sencilla</p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-class">Object</span><span class="shj-syn-oper">.</span><span class="shj-syn-func">create</span> <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">function</span> (proto) {
  <span class="shj-syn-kwd">function</span> <span class="shj-syn-num">F</span>() {}
  <span class="shj-syn-num">F</span><span class="shj-syn-oper">.</span>prototype <span class="shj-syn-oper">=</span> proto;
  <span class="shj-syn-kwd">return</span> <span class="shj-syn-kwd">new</span> <span class="shj-syn-num">F</span>();
};</div></div>
</code>
<p>Y empecÃ© a crear un montÃ³n de objetos y a prototiparlos, pero como los objetos muchas veces necesitaban inicializar sus propiedades les hice el mÃ©todo <code>.init()</code></p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">var</span> base <span class="shj-syn-oper">=</span> {
  init<span class="shj-syn-oper">:</span> <span class="shj-syn-kwd">function</span> () {
    <span class="shj-syn-class">EmitterMixin</span><span class="shj-syn-oper">.</span><span class="shj-syn-func">call</span>(<span class="shj-syn-kwd">this</span>);
    <span class="shj-syn-kwd">return</span> <span class="shj-syn-kwd">this</span>;
  }<span class="shj-syn-oper">,</span>
};

<span class="shj-syn-kwd">var</span> obj <span class="shj-syn-oper">=</span> <span class="shj-syn-class">Object</span><span class="shj-syn-oper">.</span><span class="shj-syn-func">create</span>(base)<span class="shj-syn-oper">.</span><span class="shj-syn-func">init</span>();</div></div>
</code>
<p>Pero claro, tengo que acordarme de devolver <code>this</code> siempre al acabar <code>.init()</code> y muchas veces lo olvidaba o me olvidaba de invocar <code>.init()</code> que es peor. AsÃ­ que intentando como simplificar la inicializaciÃ³n de un objeto pensÃ© crear una funcioÅ„ global que se encargara de invocar a <code>Object.create</code>, llamar a la funciÃ³n inicializadora y devolver this:</p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">function</span> <span class="shj-syn-func">create</span>(proto) {
  <span class="shj-syn-kwd">var</span> child <span class="shj-syn-oper">=</span> <span class="shj-syn-class">Object</span><span class="shj-syn-oper">.</span><span class="shj-syn-func">create</span>(proto);
  child<span class="shj-syn-oper">.</span><span class="shj-syn-func">init</span>();
  <span class="shj-syn-kwd">return</span> child;
}</div></div>
</code>
<p>Y me empezaron a dar ganas de reventarme la cabeza contra la pared al darme cuenta que <strong>lo que estaba haciendo es prÃ¡cticamente lo mismo que hace el operador nativo <code>new</code></strong> pero mucho mÃ¡s lento y, en caso de usar el polyfill the <code>Object.create</code> incluso usando <code>new</code> por debajo.</p>
<p>Entonces me pregunto, que beneficios aporta abandonar <code>new</code>? es <a href="http://jsperf.com/object-create-vs-constructor-vs-object-literal/49">notablemente mÃ¡s rÃ¡pido</a> en la mayorÃ­a de navegadores y por la naturaleza de javascript solemos necesitar crear una funciÃ³n inicializadora que en el caso de <code>new</code> es el constructor.</p>
<p>Y lo que es mÃ¡s grave aÃºn, he notado que <strong>usaba dos tipos diferentes de objetos</strong>, unos &quot;<em>abstractos</em>&quot; y otros &quot;<em>instancias</em>&quot; la mayor diferencia es que en las instancias tenÃ­a que invocar <code>.init()</code> siempre mientras que los abstractos no era necesario porque solo serÃ­an usados para crear otros objetos que los prototiparan. Y es un patrÃ³n que he visto mientras usaba <code>new</code>:</p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">function</span> <span class="shj-syn-class">Foo</span>() { }
<span class="shj-syn-class">Foo</span><span class="shj-syn-oper">.</span>prototype<span class="shj-syn-oper">.</span><span class="shj-syn-func">method</span> <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">function</span>() { <span class="shj-syn-oper">...</span> };

<span class="shj-syn-kwd">function</span> <span class="shj-syn-class">Bar</span>() { }
<span class="shj-syn-cmnt">// Objeto "abstracto", no se invoca inicializador
</span><span class="shj-syn-class">Bar</span><span class="shj-syn-oper">.</span>prototype <span class="shj-syn-oper">=</span> <span class="shj-syn-class">Object</span><span class="shj-syn-oper">.</span><span class="shj-syn-func">create</span>(<span class="shj-syn-class">Foo</span><span class="shj-syn-oper">.</span>prototype);
<span class="shj-syn-class">Bar</span><span class="shj-syn-oper">.</span>prototype<span class="shj-syn-oper">.</span><span class="shj-syn-func">other</span> <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">function</span>() { <span class="shj-syn-oper">...</span> };

<span class="shj-syn-cmnt">// Objeto "instancia"
</span><span class="shj-syn-cmnt">// se invoca el constructor como inicializador
</span><span class="shj-syn-kwd">var</span> obj <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">new</span> <span class="shj-syn-class">Bar</span>();</div></div>
</code>
<p>Realmente hay es una ventaja abandonar <code>new</code>? estamos seguros que no se trata de una herramienta de alto nivel que simplifica algo que igualmente tendremos que hacer nosotros a mano? Que pros y contras tienen <code>new</code> y <code>Object.create</code>?</p>
</div></article></div></body></html>