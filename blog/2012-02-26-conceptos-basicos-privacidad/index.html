<!DOCTYPE html><html lang="en"><head><meta charSet="UTF-8"/><meta name="description" content="A. MatÃ­as Quezada&#x27;s personal website"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Conceptos BÃ¡sicos Javascript: Privacidad (ðŸ‡ªðŸ‡¸ only) | A. MatÃ­as Quezada</title><style> *, *::before, *::after { box-sizing: border-box; } ul, ol { padding: 0; } body, h1, h2, h3, h4, p, ul, ol, li, figure, figcaption, blockquote, dl, dd { margin: 0; } body { min-height: 100vh; scroll-behavior: smooth; text-rendering: optimizeSpeed; line-height: 1.5; } ul, ol { list-style: none; } .md ul, .md ol { list-style: initial; padding: revert; } a:not([class]) { text-decoration-skip-ink: auto; } img { max-width: 100%; display: block; } article > * + * { margin-top: 1em; } input, button, textarea, select { font: inherit; } @media (prefers-reduced-motion: reduce) { * { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; scroll-behavior: auto !important; } } </style><style>@font-face { font-family: 'Fira Code'; font-style: normal; font-weight: 400; font-display: swap; src: url(https://fonts.gstatic.com/s/firacode/v21/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sFVc.ttf) format('truetype'); } @font-face { font-family: 'Fira Code'; font-style: normal; font-weight: 700; font-display: swap; src: url(https://fonts.gstatic.com/s/firacode/v21/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_NprFVc.ttf) format('truetype'); } @font-face { font-family: 'Lato'; font-style: italic; font-weight: 400; font-display: swap; src: url(https://fonts.gstatic.com/s/lato/v23/S6u8w4BMUTPHjxswWw.ttf) format('truetype'); } @font-face { font-family: 'Lato'; font-style: italic; font-weight: 700; font-display: swap; src: url(https://fonts.gstatic.com/s/lato/v23/S6u_w4BMUTPHjxsI5wqPHA.ttf) format('truetype'); } @font-face { font-family: 'Montserrat'; font-style: normal; font-weight: 400; font-display: swap; src: url(https://fonts.gstatic.com/s/montserrat/v24/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Ew-.ttf) format('truetype'); } @font-face { font-family: 'Montserrat'; font-style: normal; font-weight: 700; font-display: swap; src: url(https://fonts.gstatic.com/s/montserrat/v24/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCuM70w-.ttf) format('truetype'); } </style><style> :root { background-color: #263238; color: #FDFBF8; font-family: Lato, sans-serif; font-size: 18px; --border-color: #586369; } header, h1, h2, h3, h4, h5, h6 { font-family: Montserrat, sans-serif; } a { color: #EFE751; } .md p { margin: 20px 0; text-align: justify; } code { font-family: Fira Code, monospace; } .md .code-block { display: block; font-family: Fira Code, monospace; width: var(--available-width); padding-bottom: 10px; } .md h3 { margin-top: 20px; margin-bottom: 20px; } svg { fill: #FDFBF8; } </style><style> [class*=shj-lang-]{white-space:pre;margin:10px 0;border-radius:10px;padding:30px 20px;background:white;color:#112;box-shadow:0 0 5px #0001;text-shadow:none;font: 18px Consolas,Courier New,Monaco,Andale Mono,Ubuntu Mono,monospace;line-height:24px;box-sizing:border-box;max-width:min(100%,100vw)} .shj-inline{margin:0;padding:2px 5px;display:inline-block;border-radius:5px} [class*=shj-lang-]::selection, [class*=shj-lang-] ::selection{background:#bdf5} [class*=shj-lang-]>div{display:flex;overflow:auto} [class*=shj-lang-]>div :last-child{flex:1;outline:none} .shj-numbers{padding-left:5px;counter-reset:line} .shj-numbers div{padding-right:5px} .shj-numbers div:before{color:#999;display:block;content:counter(line);opacity:.5;text-align:right;margin-right:5px;counter-increment:line} .shj-syn-cmnt{font-style:italic} .shj-syn-err, .shj-syn-kwd{color:#e16} .shj-syn-num, .shj-syn-class{color:#f60} .shj-numbers, .shj-syn-cmnt{color:#999} .shj-syn-insert, .shj-syn-str{color:#7d8} .shj-syn-bool{color:#3bf} .shj-syn-type, .shj-syn-oper{color:#5af} .shj-syn-section, .shj-syn-func{color:#84f} .shj-syn-deleted, .shj-syn-var{color:#f44} .shj-oneline{padding:12px 10px} .shj-lang-http.shj-oneline .shj-syn-kwd{background:#25f;color:#fff;padding:5px 7px;border-radius:5px} .shj-multiline.shj-mode-header{padding:20px} .shj-multiline.shj-mode-header:before{content:attr(data-lang);color:#58f;display:block;padding:10px 20px;background:#58f3;border-radius:5px;margin-bottom:20px} [class*=shj-lang-]{color:#abb2bf;background:#161b22} [class*=shj-lang-]:before{color:#6f9aff} .shj-syn-deleted, .shj-syn-err, .shj-syn-var{color:#e06c75} .shj-syn-section, .shj-syn-oper, .shj-syn-kwd{color:#c678dd} .shj-syn-class{color:#e5c07b} .shj-numbers, .shj-syn-cmnt{color:#76839a} .shj-syn-insert{color:#98c379} .shj-syn-type{color:#56b6c2} .shj-syn-num, .shj-syn-bool{color:#d19a66} .shj-syn-str, .shj-syn-func{color:#61afef} </style><style>.css-zi0qjt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}
.css-1p4f3y5{display:grid;padding-top:20px;gap:12px;}
.css-2nd93p{padding:20px 0;margin-bottom:20px;background-color:#1B2225;color:#FDFBF8;border-bottom:2px solid #586369;}@media (min-width: 769px){.css-2nd93p{position:-webkit-sticky;position:sticky;top:0;z-index:1;}}
.css-17rdaxl{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media (min-width: 769px){.css-17rdaxl{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}
.css-eexrvx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:12px;}.css-eexrvx a{color:#EFE751;-webkit-text-decoration:none;text-decoration:none;margin-left:12px;border-bottom:1px solid transparent;-webkit-transform:translate(0px, 0px);-moz-transform:translate(0px, 0px);-ms-transform:translate(0px, 0px);transform:translate(0px, 0px);}.css-eexrvx a.parent{border-bottom:1px solid #586369;}.css-eexrvx a:hover{border-bottom:1px solid #EFE751;-webkit-transition:-webkit-transform 1s ease;transition:transform 1s ease;-webkit-transform:translate(0px, -3px);-moz-transform:translate(0px, -3px);-ms-transform:translate(0px, -3px);transform:translate(0px, -3px);}
.css-18wymod{--container-side-gap:1rem;--container-width:40rem;--container-sides-gap:calc(var(--container-side-gap) * 2);--available-width:min(
      calc(100vw - var(--container-sides-gap)),
      calc(var(--container-width) - var(--container-sides-gap))
    );max-width:var(--container-width);padding-left:var(--container-side-gap);padding-right:var(--container-side-gap);margin-left:auto;margin-right:auto;}@media (min-width: 769px){.css-18wymod{--container-width:50rem;--container-side-gap:3rem;}}@media (min-width: 1200px){.css-18wymod{--container-width:60rem;}}
.css-hlqr5i{font-size:24px;-webkit-text-decoration:none;text-decoration:none;color:#FFFFFF;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:baseline;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;letter-spacing:1px;}.css-hlqr5i abbr{display:inline-block;width:0.8em;margin-right:0.35em;overflow:hidden;-webkit-transition:width 0.3s ease;transition:width 0.3s ease;}.css-hlqr5i:hover abbr{width:3.75em;}
.css-187qu0u{font-family:Montserrat,sans-serif;font-weight:700;font-size:32px;}
.css-a9renj{opacity:0.8;font-family:Fira Code,monospace;color:#FDFBF8;}</style></head><body class=""><header class="css-2nd93p "><div class="css-17rdaxl css-18wymod"><h2><a href="../.." class="css-hlqr5i"><abbr>Adrian</abbr> MatÃ­as Quezada</a></h2><nav class="css-eexrvx"><a href=".." class="parent">Blog</a><a href="../../career" class="">Career</a><a href="../../projects" class="">Projects</a><a href="../../es/blog/2012-02-26-conceptos-basicos-privacidad" class="">ðŸ‡ªðŸ‡¸</a></nav></div></header><div class="css-1p4f3y5 css-18wymod"><div class="css-zi0qjt"><h2 class="undefined css-187qu0u">Conceptos BÃ¡sicos Javascript: Privacidad (ðŸ‡ªðŸ‡¸ only)</h2><time class="css-a9renj " dateTime="02/26/2012">Feb 26, 2012</time></div><article><div class="md"><h3 id="introducci-n">IntroducciÃ³n</h3>
<p>Uno de los temas mÃ¡s frecuentes cuando uno se inicia en Javascript es la privacidad, principalmente viniendo de <strong>lenguajes como Java, C# o C++; donde publican o se ocultan propiedades de los objetos mediante modificadores. Javascript</strong> no posee dichos modificadores sino que <strong>todas las propiedades de los objetos son pÃºblicas</strong> lo que puede ser muy confuso para una persona poco diestra en Ã©sta tÃ©cnica, entre los que me incluyo.</p>
<p>Personalmente cuando diseÃ±o un componente (objeto/clase/librerÃ­a), es porque quiero que ese componente cumpla una funcionalidad, por ejemplo, si yo quiero tener una clase que represente a una impresora necesito enviarle datos y que los imprima; <strong>mi prioridad es que dicho componente sea sencillo de utilizar, lo que facilita la reutilizaciÃ³n del componente</strong>. Por lo que primero imagino cÃ³mo me gustarÃ­a usarlo:</p>
<!-- end extract -->

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">var</span> impresora <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">new</span> <span class="shj-syn-class">Impresora</span>();
impresora<span class="shj-syn-oper">.</span><span class="shj-syn-func">encender</span>();
impresora<span class="shj-syn-oper">.</span><span class="shj-syn-func">imprimir</span>(datos);
impresora<span class="shj-syn-oper">.</span><span class="shj-syn-func">apagar</span>();</div></div>
</code>
<p>Como se ve, para cumplir la funcionalidad me basta con tres mÃ©todos, pero si yo escribo mi clase impresora con solo tres mÃ©todos probablemente duplicarÃ­a mucho cÃ³digo, por ejemplo, que <code>.imprimir()</code> y <code>.apagar()</code> deban comprobar si hay papel en la impresora.</p>
<!--more Seguir leyendo â†’ -->
<h3 id="soluciones">Soluciones</h3>
<h4 id="hacer-toda-la-interfaz-p-blica">Hacer toda la interfaz pÃºblica</h4>
<p>PodrÃ­amos crear in mÃ©todo pÃºblico <code>.hayPapel()</code>, pero personalmente prefiero que la API, la interfaz pÃºblica de mi componente sea tan sencilla como sea posible por lo que no quiero hacer Ã©se mÃ©todo pÃºblico. <strong>Cuando tengo que usar una librerÃ­a ajena no quiero saber cÃ³mo estÃ¡ hecha, quiero saber como usarla</strong>. Por ello si Ã©sta clase tiene el mÃ©todo <code>.hayPapel()</code> le estoy diciendo al programador que ese mÃ©todo estÃ¡ ahÃ­ para usarlo, cuando en realidad no es asÃ­, ese mÃ©todo estÃ¡ ahÃ­ para ayudarme a mi como desarrollador de la clase a no duplicar cÃ³digo.</p>
<h4 id="usar-la-convenci-n-de-barra-baja-underscore-_-">Usar la convenciÃ³n de Barra Baja (Underscore, &#39;<code>_</code>&#39;)</h4>
<p>Una prÃ¡ctica muy comÃºn en Javascript es aÃ±adir al principio o al final del nombre de la propiedad el sÃ­mbolo barra baja con lo que la propiedad es pÃºblica, pero <strong>por convenciÃ³n las propiedades que empiezan o finalizan con barra baja no deben ser llamadas desde fuera del componente</strong>:</p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">function</span> <span class="shj-syn-class">Impresora</span>() { }
<span class="shj-syn-class">Impresora</span><span class="shj-syn-oper">.</span>prototype <span class="shj-syn-oper">=</span> {
    encender<span class="shj-syn-oper">:</span> <span class="shj-syn-kwd">function</span>() { <span class="shj-syn-oper">...</span> }<span class="shj-syn-oper">,</span>
    apagar<span class="shj-syn-oper">:</span> <span class="shj-syn-kwd">function</span>() { <span class="shj-syn-oper">...</span> }<span class="shj-syn-oper">,</span>
    imprimir<span class="shj-syn-oper">:</span> <span class="shj-syn-kwd">function</span>(datos) { <span class="shj-syn-oper">...</span> }<span class="shj-syn-oper">,</span>
    _hayPapel<span class="shj-syn-oper">:</span> <span class="shj-syn-kwd">function</span>() { <span class="shj-syn-oper">...</span> }
};</div></div>
</code>
<p>Este es el mÃ©todo mÃ¡s extendido que he visto en Javascript, porque es una soluciÃ³n que <strong>no afecta al tiempo de ejecuciÃ³n del programa</strong>. Javascript simplemente accede a una propiedad pÃºblica sin pÃ©rdida de rendimiento. Es una buena soluciÃ³n siempre que se respete la convenciÃ³n, de lo contrario estarÃ­amos acoplando componentes. Eso quiere decir que si quiero hacer pÃºblica una propiedad tengo que cambiarle el nombre en todos los puntos en que la utilizo? Desgraciadamente si, pero siempre tienes el consuelo de que serÃ¡ dentro de tu propia librerÃ­a, ya que si cambias una variable de privada a pÃºblica no deberÃ­a haber ningÃºn punto fuera de tu cÃ³digo que accediera a Ã©sa propiedad, y si lo que estÃ¡s haciendo es cambiarla de pÃºblica a privada... bueno, evidentemente hay que refactorizar el cÃ³digo que utilizara tu librerÃ­a de cualquier forma.</p>
<h4 id="privacidad-por-constructor">Privacidad por constructor</h4>
<p>Los closures son un curioso mÃ©todo de privacidad, cuando creamos una funciÃ³n dentro de otra, <strong>la funciÃ³n hija puede acceder a las variables de la funciÃ³n padre, pero no al revÃ©s</strong>:</p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">var</span> a <span class="shj-syn-oper">=</span> <span class="shj-syn-num">5</span>;

<span class="shj-syn-kwd">function</span>() {
    <span class="shj-syn-kwd">var</span> b <span class="shj-syn-oper">=</span> <span class="shj-syn-num">6</span>;

    <span class="shj-syn-kwd">function</span>() {
        <span class="shj-syn-kwd">var</span> c <span class="shj-syn-oper">=</span> <span class="shj-syn-num">7</span>;
        <span class="shj-syn-cmnt">// Desde aquÃ­ puedo acceder a 'a', 'b' y 'c'
</span>    }

    <span class="shj-syn-cmnt">// Desde aquÃ­ puedo acceder a 'a' y 'b'.
</span>    <span class="shj-syn-cmnt">// 'c' no existe
</span>}

<span class="shj-syn-cmnt">// Desde aquÃ­ solo puedo acceder a 'a'.
</span><span class="shj-syn-cmnt">// 'b' y 'c' no existen</span></div></div>
</code>
<p>Con Ã©sto podemos buscar la privacidad, si analizamos el constructor de la clase <code>Impresora</code> veremos que es una funciÃ³n, igual que las del ejemplo. De alguna forma <strong>podemos crear variables privadas ahÃ­</strong>.</p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">function</span> <span class="shj-syn-class">Impresora</span>() {
  <span class="shj-syn-kwd">var</span> a <span class="shj-syn-oper">=</span> <span class="shj-syn-str">'Privada!'</span>;
  console<span class="shj-syn-oper">.</span><span class="shj-syn-func">log</span>(<span class="shj-syn-str">'Accediendo desde dentro:'</span> <span class="shj-syn-oper">+</span> a);
}

<span class="shj-syn-kwd">var</span> temp <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">new</span> <span class="shj-syn-class">Impresora</span>();
console<span class="shj-syn-oper">.</span><span class="shj-syn-func">log</span>(<span class="shj-syn-str">"Intentando acceder desde fuera usando 'temp.a': "</span> <span class="shj-syn-oper">+</span> temp<span class="shj-syn-oper">.</span>a);

<span class="shj-syn-cmnt">// Esta lÃ­nea no se ejecuta porque 'a' no existe aquÃ­ y falla.
</span>console<span class="shj-syn-oper">.</span><span class="shj-syn-func">log</span>(<span class="shj-syn-str">"Intentando acceder desde fuera usando 'a': "</span> <span class="shj-syn-oper">+</span> a);</div></div>
</code>
<p><a href="http://jsfiddle.net/amatiasq/qJnvS/" target="_blank">PruÃ©bame</a></p>
<p>Funciona! Ahora aÃ±adamos los mÃ©todos:</p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">function</span> <span class="shj-syn-class">Impresora</span>() {
  <span class="shj-syn-kwd">var</span> a <span class="shj-syn-oper">=</span> <span class="shj-syn-str">'Privada!'</span>;
}

<span class="shj-syn-class">Impresora</span><span class="shj-syn-oper">.</span>prototype <span class="shj-syn-oper">=</span> {
  probando<span class="shj-syn-oper">:</span> <span class="shj-syn-kwd">function</span> () {
    console<span class="shj-syn-oper">.</span><span class="shj-syn-func">log</span>(<span class="shj-syn-str">"Intentando acceder desde un mÃ©todo usando 'this.a': "</span> <span class="shj-syn-oper">+</span> <span class="shj-syn-kwd">this</span><span class="shj-syn-oper">.</span>a);

    <span class="shj-syn-cmnt">// Esta lÃ­nea no se ejecuta porque 'a' no existe aquÃ­ y falla.
</span>    console<span class="shj-syn-oper">.</span><span class="shj-syn-func">log</span>(<span class="shj-syn-str">"Intentando acceder desde un mÃ©todo usando 'a': "</span> <span class="shj-syn-oper">+</span> a);
  }<span class="shj-syn-oper">,</span>
};

<span class="shj-syn-kwd">var</span> temp <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">new</span> <span class="shj-syn-class">Impresora</span>();
temp<span class="shj-syn-oper">.</span><span class="shj-syn-func">probando</span>();</div></div>
</code>
<p><a href="http://jsfiddle.net/amatiasq/jQLQf/" target="_blank">PruÃ©bame</a></p>
<p>Pero no podemos acceder desde los mÃ©todos! <strong>Porque no estÃ¡n dentro del closure</strong>, de que nos sirve una variable privada si no podemos acceder a ella desde los mÃ©todos pÃºblicos? Hay una soluciÃ³n: el closure en el que hemos guardado la variable privada es el constructor del objeto, por lo que podrÃ­amos aprovechar el dinamismo de Javascript e injectar los mÃ©todos en el objeto dentro del constructor, asÃ­ los mÃ©todos podrÃ­an acceder a las variables privadas:</p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">function</span> <span class="shj-syn-class">Impresora</span>() {
  <span class="shj-syn-kwd">var</span> a <span class="shj-syn-oper">=</span> <span class="shj-syn-str">'Privada!'</span>;

  <span class="shj-syn-cmnt">// This es el objeto que Ã©ste constructor estÃ¡ creando
</span>  <span class="shj-syn-kwd">this</span><span class="shj-syn-oper">.</span><span class="shj-syn-func">probando</span> <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">function</span> () {
    console<span class="shj-syn-oper">.</span><span class="shj-syn-func">log</span>(<span class="shj-syn-str">"Intentando acceder desde un mÃ©todo usando 'this.a': "</span> <span class="shj-syn-oper">+</span> <span class="shj-syn-kwd">this</span><span class="shj-syn-oper">.</span>a);
    console<span class="shj-syn-oper">.</span><span class="shj-syn-func">log</span>(<span class="shj-syn-str">"Intentando acceder desde un mÃ©todo usando 'a': "</span> <span class="shj-syn-oper">+</span> a);
  };
}

<span class="shj-syn-kwd">var</span> temp <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">new</span> <span class="shj-syn-class">Impresora</span>();
temp<span class="shj-syn-oper">.</span><span class="shj-syn-func">probando</span>();</div></div>
</code>
<p><a href="http://jsfiddle.net/amatiasq/gRVqv/" target="_blank">PruÃ©bame</a></p>
<p>Bien! Ã©ste sistema funciona, verdad? No tiene ningÃºn inconveniente? Bueno, tiene uno, pero no es visible a simple vista porque nuestro cerebro y el intÃ©rprete de Javascript funcionan de forma distinta. <strong>Para nosotros <code>this.probando = function() { ... }</code> es crear una funciÃ³n y aÃ±adirla a todos las instancias de <code>Impresora</code></strong> pero el intÃ©rprete no lo ve asÃ­, para la mÃ¡quina Javascript <strong>estamos creando una funciÃ³n por cada mÃ©todo para cada instancia</strong> y tiene sentido, si la primera funciÃ³n <code>probando</code> que creamos accede a la variable privada <code>a</code> de la primera instancia que creamos necesitaremos una funciÃ³n distinta para acceder a la variable privada de la segunda instancia que creemos.</p>
<p>Eso quiere decir que <strong>si creamos 10.000 instancias de <code>Impresora</code> tendremos 10.000 funciones que hacen casi lo mismo en la memoria? Si.</strong> Con las computadoras actuales es casi despreciable, pero si estamos manejando un proyecto en Javascript que puede estar creando y borrando instancias de la clase durante dÃ­as (por ejemplo un programa de servidor o una RIA), tendremos un problema a medio plazo.</p>
<h3 id="privacidad-de-librer-a">Privacidad de librerÃ­a</h3>
<p>Ahora tengo que confesar que he hecho trampas, todos los patrones descritos son para hacer privacidad a nivel de clase, pero <strong>hay una forma mÃ¡s sencilla de hacer privada una clase entera, los closures</strong>. Ahora pensarÃ¡s &quot;pero me acabas de decir que los closures volvÃ­an a crear los mÃ©todos por cada instancia!&quot; si, cuando el closure es el constructor. <strong>Pero si englobamos toda la clase en un closure podemos tener privacidad a nivel de librerÃ­a:</strong></p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-cmnt">// funciÃ³n de ejecuciÃ³n inmediata, se crea, se ejecuta y no se vuelve a utilizar
</span><span class="shj-syn-cmnt">// es el closure que guardarÃ¡ la privacidad
</span>(<span class="shj-syn-kwd">function</span> (global) {
  <span class="shj-syn-kwd">var</span> contador <span class="shj-syn-oper">=</span> <span class="shj-syn-num">0</span>;

  <span class="shj-syn-kwd">function</span> <span class="shj-syn-class">Impresora</span>() {
    contador<span class="shj-syn-oper">++</span>;
  }

  <span class="shj-syn-cmnt">// Creamos un mÃ©todo estÃ¡tico
</span>  <span class="shj-syn-class">Impresora</span><span class="shj-syn-oper">.</span><span class="shj-syn-func">cantidadDeInstancias</span> <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">function</span> () {
    <span class="shj-syn-kwd">return</span> contador;
  };

  global<span class="shj-syn-oper">.</span><span class="shj-syn-class">Impresora</span> <span class="shj-syn-oper">=</span> <span class="shj-syn-class">Impresora</span>;
})(<span class="shj-syn-kwd">this</span>);

<span class="shj-syn-kwd">var</span> temp <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">new</span> <span class="shj-syn-class">Impresora</span>();
<span class="shj-syn-kwd">var</span> temp2 <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">new</span> <span class="shj-syn-class">Impresora</span>();
console<span class="shj-syn-oper">.</span><span class="shj-syn-func">log</span>(<span class="shj-syn-class">Impresora</span><span class="shj-syn-oper">.</span><span class="shj-syn-func">cantidadDeInstancias</span>());</div></div>
</code>
<p><a href="http://jsfiddle.net/amatiasq/HJzAB/" target="_blank">PruÃ©bame</a></p>
<p>La variable <code>contador</code> es <strong>privada a nivel de librerÃ­a</strong>, significa que <strong>todo lo que estÃ© dentro del closure accede a ella</strong> y como podemos ver todo el cÃ³digo dentro del closure accede a la misma variable, lo que significa que todas las instancias de <code>Impresora</code> comparten la misma variable. TambiÃ©n podemos usar Ã©ste patrÃ³n para ocultar clases y funciones, <strong>lo Ãºnico que serÃ¡ publicado de dentro del closure serÃ¡ lo que guardemos en la variable <code>global</code>.</strong></p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-cmnt">// funciÃ³n de ejecuciÃ³n inmediata, se crea, se ejecuta y no se vuelve a utilizar
</span><span class="shj-syn-cmnt">// es el closure que guardarÃ¡ la privacidad
</span>(<span class="shj-syn-kwd">function</span> (global) {
  <span class="shj-syn-kwd">function</span> <span class="shj-syn-class">Papel</span>() {}
  <span class="shj-syn-class">Papel</span><span class="shj-syn-oper">.</span>prototype <span class="shj-syn-oper">=</span> {
    hayPapelEn<span class="shj-syn-oper">:</span> <span class="shj-syn-kwd">function</span> (impresora) {
      <span class="shj-syn-cmnt">// no hay papel
</span>      <span class="shj-syn-kwd">return</span> <span class="shj-syn-bool">false</span>;
    }<span class="shj-syn-oper">,</span>
    pedirAlUsuario<span class="shj-syn-oper">:</span> <span class="shj-syn-kwd">function</span> () {
      console<span class="shj-syn-oper">.</span><span class="shj-syn-func">log</span>(<span class="shj-syn-str">'Oye tu! ponme papel!'</span>);
    }<span class="shj-syn-oper">,</span>
  };

  <span class="shj-syn-kwd">var</span> papel <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">new</span> <span class="shj-syn-class">Papel</span>();

  <span class="shj-syn-kwd">function</span> <span class="shj-syn-class">Impresora</span>() {}
  <span class="shj-syn-class">Impresora</span><span class="shj-syn-oper">.</span>prototype <span class="shj-syn-oper">=</span> {
    imprimir<span class="shj-syn-oper">:</span> <span class="shj-syn-kwd">function</span> (datos) {
      <span class="shj-syn-kwd">if</span> (<span class="shj-syn-oper">!</span>papel<span class="shj-syn-oper">.</span><span class="shj-syn-func">hayPapelEn</span>(<span class="shj-syn-kwd">this</span>)) papel<span class="shj-syn-oper">.</span><span class="shj-syn-func">pedirAlUsuario</span>();
      <span class="shj-syn-cmnt">// imprimir
</span>    }<span class="shj-syn-oper">,</span>
  };

  global<span class="shj-syn-oper">.</span><span class="shj-syn-class">Impresora</span> <span class="shj-syn-oper">=</span> <span class="shj-syn-class">Impresora</span>;
})(<span class="shj-syn-kwd">this</span>);

<span class="shj-syn-kwd">var</span> temp <span class="shj-syn-oper">=</span> <span class="shj-syn-kwd">new</span> <span class="shj-syn-class">Impresora</span>();
temp<span class="shj-syn-oper">.</span><span class="shj-syn-func">imprimir</span>();</div></div>
</code>
<p><a href="http://jsfiddle.net/amatiasq/vc2ke/" target="_blank">PruÃ©bame</a></p>
<p>Este es un patrÃ³n muy recomendable, ya que mediante una funciÃ³n autoejecutable ocultamos todo lo que el usuario de nuestra librerÃ­a no necesita conocer. Por poner un ejemplo, <a href="http://nodejs.org/">node.js</a> utiliza un patrÃ³n similar para generar librerÃ­as, en las que todas las variables que creamos en el archivo .js quedan ocultas y solo se exponen las propiedades que aÃ±adimos al objeto global <code>exports</code>. Ejemplo de saludo.js:</p>

<code class="code-block shj-lang-js"><div><div class="shj-numbers"><div></div><div></div><div></div><div></div><div></div></div><div><span class="shj-syn-kwd">var</span> saludo <span class="shj-syn-oper">=</span> <span class="shj-syn-str">'Hola!'</span>;
<span class="shj-syn-kwd">function</span> <span class="shj-syn-func">saludar</span>() {
  console<span class="shj-syn-oper">.</span><span class="shj-syn-func">log</span>(saludo);
}
exports<span class="shj-syn-oper">.</span>saludar <span class="shj-syn-oper">=</span> saludar;</div></div>
</code>
<p>Si tuviera que decir un defecto de Ã©ste patrÃ³n, es que <strong>todo lo que queramos englobar dentro del closure deberÃ¡ estar en el mismo archivo</strong>, ya que el cÃ³digo debe estar dentro del closure y Ã©ste no puede estar repartido entre archivos. Ã‰sto es un problema si queremos que dos clases con mucha lÃ³gica se comuniquen y no queremos acabar con un archivo de 1.000 lÃ­neas de cÃ³digo.</p>
<h3 id="resumen">Resumen</h3>
<p>No voy a opinar si la decisiÃ³n de hacer todo pÃºblico al crear Javascript es buena o mala porque en mi opiniÃ³n <strong>no es que hacer todo pÃºblico sea malo, sino que no estamos acostrumbrados a utilizarlo</strong>. Por ello, porque la mayorÃ­a de los programadores estamos acostumbrado a tener privacidad en los componentes, buscamos entre las opciones que nos da el lenguaje para simularlo.</p>
<p>En cuanto a mi, me parece interesante las posibilidades de un lenguaje tan flexible como Javascript a nivel acadÃ©mico, al fin y al cabo el objetivo de la investigaciÃ³n es tener la mente flexible para que a la hora de la verdad podamos ver caminos alternativos que nos ofrecen una mejor soluciÃ³n para un problema en particular. Un ejemplo de Ã©sto es un patrÃ³n de privacidad por instancia que descubrÃ­ recientemente, hablarÃ© de Ã©l en el [prÃ³ximo post][2].</p>
<p>[2]: <a href="http://www.amatiasq.com/?p=208">http://www.amatiasq.com/?p=208</a> &#39;Experimento: Privacidad por instancias&#39;</p>
<p>[2]: <a href="http://www.amatiasq.com/?p=208">http://www.amatiasq.com/?p=208</a> &#39;Experimento: Privacidad por instancias&#39;</p>
</div></article></div></body></html>