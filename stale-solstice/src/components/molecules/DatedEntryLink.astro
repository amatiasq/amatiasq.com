---
import type { CollectionEntry, ContentEntryMap, DataEntryMap } from 'astro:content';
import Link from "@components/atoms/Link.astro";
import Tr from "@components/atoms/Tr.astro";
import { parseDate, getSlugWithoutDate, printDate, getLocale } from "@util/date";

type AnyEntryMap = ContentEntryMap & DataEntryMap;

interface Props<C extends keyof AnyEntryMap> {
    class?: string;
    collection: C;
    entry: CollectionEntry<C>
}

const { class: className, collection, entry } = Astro.props as Props<keyof AnyEntryMap>
const slug = getSlugWithoutDate(entry);
const date = parseDate(entry);
const locale = getLocale(Astro.url);
---

<amq-dated-entry>
    {date ? <time datetime={date}>{printDate(locale, date, { omitDay: true })}</time> : null}
    <Link page={`/${collection}/${slug}`} class={className}>
        <slot name="entry-title">
            <Tr value={entry.data.title} />
        </slot>
    </Link>
</amq-dated-entry>

<style lang="scss" is:global>
    amq-dated-entry {
        display: flex;
        align-items: center;
        gap: 1rem;

        time {
            font-family: var(--font-family-code);
            font-size: 0.8rem;
            color: var(--color-text-muted);
        }
    }
</style>
