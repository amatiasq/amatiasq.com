<!DOCTYPE html><html lang="en"><head><meta charSet="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Conceptos B√°sicos Javascript: Herencia por prototipos</title><style>
  /* Box sizing rules */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  /* Remove default padding */
  ul, ol {
    padding: 0;
  }

  /* Remove default margin */
  body, h1, h2, h3, h4, p, ul, ol, li, figure, figcaption, blockquote, dl, dd {
    margin: 0;
  }

  /* Set core body defaults */
  body {
    min-height: 100vh;
    scroll-behavior: smooth;
    text-rendering: optimizeSpeed;
    line-height: 1.5;
  }

  ul, ol, summary {
    list-style: none;
  }
  .md ul, .md ol {
    list-style: initial;
    padding: revert;
  }

  /* A elements that don&#x27;t have a class get default styles */
  a:not([class]) {
    text-decoration-skip-ink: auto;
  }

  /* Make images easier to work with */
  img {
    max-width: 100%;
    display: block;
  }

  /* Natural flow and rhythm in articles by default */
  article &gt; * + * {
    margin-top: 1em;
  }

  /* Inherit fonts for inputs and buttons */
  input, button, textarea, select {
    font: inherit;
  }

  /* Remove all animations and transitions for people that prefer not to see them */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }

  @import url(&#x27;https://fonts.googleapis.com/css2?family=Lato:ital,wght@1,400;1,700&amp;family=Montserrat:wght@400;700&amp;display=swap&#x27;);

  :root {
    background-color: #263238;
    color: #FDFBF8;
    font-family: Lato, sans-serif;
    font-size: 18px;
  }

  header, h1, h2, h3, h4, h5, h6 {
    font-family: Montserrat, sans-serif;
  }

  a {
    color: #EFE751;
  }

  .md p {
    margin: 20px 0;
    text-align: justify;
  }

  .md pre {
    white-space: break-spaces;
  }

  svg {
    fill: #FDFBF8;
  }
</style><style>.css-zi0qjt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}
.css-1p4f3y5{display:grid;padding-top:20px;gap:12px;}
.css-2nd93p{padding:20px 0;margin-bottom:20px;background-color:#1B2225;color:#FDFBF8;border-bottom:2px solid #586369;}@media (min-width: 769px){.css-2nd93p{position:-webkit-sticky;position:sticky;top:0;z-index:1;}}
.css-17rdaxl{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media (min-width: 769px){.css-17rdaxl{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}
.css-slvbys{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:12px;}.css-slvbys a{color:#EFE751;-webkit-text-decoration:none;text-decoration:none;margin-left:12px;border-bottom:1px solid transparent;}.css-slvbys a.parent{border-bottom:1px solid #586369;}.css-slvbys a:hover{border-bottom:1px solid #EFE751;}
.css-1avicn7{font-size:24px;-webkit-text-decoration:none;text-decoration:none;color:#FDFBF8;}
.css-2u52bv{max-width:30rem;margin-left:auto;margin-right:auto;padding-left:1rem;padding-right:1rem;}@media (min-width: 769px){.css-2u52bv{max-width:50rem;padding-left:5rem;padding-right:5rem;}}@media (min-width: 1200px){.css-2u52bv{max-width:60rem;padding-left:5rem;padding-right:5rem;}}
.css-187qu0u{font-family:Montserrat,sans-serif;font-weight:700;font-size:32px;}
.css-bkztrs{opacity:0.8;font-family:monospace;color:#FDFBF8;}</style></head><body class=""><header class="css-2nd93p "><div class="css-17rdaxl css-2u52bv"><h2><a href="../../.." class="css-1avicn7">A. Mat√≠as Quezada</a></h2><nav class="css-slvbys"><a href="../../../blog" class="">Blog</a><a href="../../../career" class="">Experiencia</a><a href="../../../projects" class="">Proyectos</a><a href="../../../blog/2012-01-18-conceptos-basicos-herencia-por-prototipos" class="">üá¨üáß</a></nav></div></header><div class="css-1p4f3y5 css-2u52bv"><div class="css-zi0qjt"><h2 class="undefined css-187qu0u">Conceptos B√°sicos Javascript: Herencia por prototipos</h2><time class="css-bkztrs " dateTime="18/01/2012">18 ene 2012</time></div><div class="md"><p>Lleg√≥ la hora de entrar el en tema que realmente confunde a los reci√©n llegados a Javascript, principalmente para quienes vienen de lenguajes que implementan la orientaci√≥n a objetos mediante clases, que son la gran mayor√≠a.</p>
<h3 id="orientaci-n-a-objetos">Orientaci√≥n a Objetos</h3>
<p>Primero deberemos aclarar que significa Programaci√≥n Orientada a Objetos (POO u OOP en ing√©s).</p>
<p><a href="https://es.wikipedia.org/wiki/Programaci%C3%B3n_orientada_a_objetos">Seg√∫n la Wikipedia</a>, la descripci√≥n es:</p>
<blockquote>
<p>es un paradigma de programaci√≥n que usa objetos y sus interacciones, para dise√±ar aplicaciones y programas inform√°ticos. Est√° basado en varias t√©cnicas, incluyendo herencia, abstracci√≥n, polimorfismo y encapsulamiento.</p>
</blockquote>
<p>Como vemos un lenguaje orientado a objetos <strong>no necesariamente tiene que implementarse mediante clases</strong>, cualquier sistema que proporcione <a href="https://es.wikipedia.org/wiki/Herencia_(programaci%C3%B3n_orientada_a_objetos)">herencia</a>, <a href="https://es.wikipedia.org/wiki/Abstracci%C3%B3n_(programaci%C3%B3n_orientada_a_objetos)">abstracci√≥n</a>, <a href="https://es.wikipedia.org/wiki/Polimorfismo_(programaci%C3%B3n_orientada_a_objetos)">polimorfismo</a> y <a href="https://es.wikipedia.org/wiki/Encapsulamiento_(programaci%C3%B3n_orientada_a_objetos)">encapsulamiento</a> es una implementaci√≥n de orientaci√≥n a objetos v√°lida. Como ya dijimos, el sistema de clases es el m√°s extendido, utilizado por C++, Java, C#, PHP, Python, ActionScript3, Perl, Objective-C, Ruby, etc... <strong>Javascript no tiene clases, utiliza el sistema de herencia por prototipos</strong>, veamos la diferencia:</p>
<!--more Seguir leyendo ‚Üí -->
<p><strong>En un lenguaje basado en clases</strong> tenemos dos tipos de conceptos, los objetos en s√≠, referencias que pueden ser almacenadas, modificadas y pasadas como argumentos. Y por otro lado <strong>las clases, objetos intangibles, no podemos guardarlos en variables ni pasar como argumento</strong>, no podemos manipularlos ni comprobar si existen excepto por reflexi√≥n, que consiste en herramientas del lenguaje para obtener objetos (tangibles, del tipo anterior) que <strong>representan a las clases</strong> a las que no podemos acceder. En un lenguaje de √©ste tipo las clases est√°n una capa por encima de los objetos y definen la herencia, abstracci√≥n, encapsulamiento y polimorfismo de los objetos que se obtendr√°n a partir de ellas, tienen una funci√≥n de plantillas para crear objetos definidas antes de ejecutarse el c√≥digo del programa.</p>
<p><strong>En un lenguaje orientado a prototipos</strong> no hay clases que definan la herencia, los objetos mismos heredan de otros objetos. No hay clases cuando el programa se inicia, sino que se crean objetos y se le ordena a otros objetos que hereden de ellos. Por ejemplo, si tenemos un objeto eventEmitter y queremos crear instancias creamos nuevos objetos y hacemos que hereden de eventEmitter.</p>
<h3 id="-prototype-">[[Prototype]]</h3>
<p>Una vez entendido el concepto podemos pasar a la pr√°ctica, sabemos que para crear instancias de clases hacemos <code>new MyClass()</code> pero c√≥mo hacemos que objetos hereden de objetos? Aqu√≠ entran los prototipos. <strong>Todos los objetos Javascript tienen una propiedad oculta que llamaremos <code>[[Prototype]]</code></strong>, con corchetes (aunque en algunos navegadores es posible acceder a ella mediante la propiedad <code>.__proto__</code>, con dos barras bajas a cada lado, pero no es est√°ndar) <strong>que es un puntero al objeto del cual hereda</strong>. Y que significa que hereda? Podr√≠amos resumir la herencia en que un objeto tiene las mismas propiedades que otro.</p>
<p>Con √©sto nos ahorramos tener que poner las mismas propiedades en m√°s de un objeto. Esto trae un nuevo concepto que puede confundir a muchos: <strong>en Javascript todo es una instancia, y cuando heredamos de un objeto tambi√©n se puede decir que estamos creando una instancia de √©se objeto</strong>, para evitar confunsiones <strong>suele decirse que un objeto &quot;extiende&quot; otro</strong>. Imaginemos que tenemos un objeto perro que hereda de animal. Que significa √©sto? que la propiedad <code>[[Prototype]]</code> de perro es animal, o lo que es lo mismo:</p>

<pre><code class="lang-js">perro.__proto__ == animal; // true
</code></pre>
<p>El c√≥digo de ejemplo es el siguiente:</p>

<pre><code class="lang-js">var animal = {};
animal.estaVivo = function () {
  return true;
};

var perro = {};
perro.__proto__ = animal;
console.log(perro.estaVivo);
</code></pre>
<p><a href="http://jsfiddle.net/amatiasq/tyK4u/" target="_blank">Pru√©bame</a></p>
<p>Vemos que <code>perro.estaVivo</code> es la funci√≥n que asignamos a <code>animal</code> c√≥mo puede ser √©sto? Por la herencia por prototipos. <strong>Javascript ha buscado la propiedad <code>estaVivo</code> en <code>perro</code> pero no la ha encontrado, entonces accede a su propiedad <code>[[Prototype]]</code> (o <code>__proto__</code>)</strong> donde nosotros guardamos <code>animal</code>. Entonces busca <code>estaVivo</code> en <code>animal</code> y lo encuentra. Por eso <code>perro.estaVivo</code> nos devuelve el m√©todo de <code>animal</code>. Podr√≠amos representarlo as√≠:</p>
<p><img src="/wp-content/uploads/2012/01/prototype.png" alt="Diagrama"></p>
<p>Y si animal no hubiese tenido la propiedad <code>estaVivo</code>? En ese caso debemos tener en cuenta que animal tambi√©n es un objeto y que todos los objetos tienen prototipo, en caso de que no le asignemos ninguno su prototipo es <code>Object.prototype</code>. Es otra forma de decir que <strong>en Javascript todos los objetos extienden <code>Object.prototype</code></strong>. <code>Object.prototype</code> es el equivalente a la clase <code>Object</code> de Java o C#.</p>

<pre><code class="lang-js">var animal = {};
console.log(animal.__proto__ === Object.prototype);
</code></pre>
<p><a href="http://jsfiddle.net/amatiasq/29S2r/" target="_blank">Pru√©bame</a></p>
<p>Y si tampoco encuentra la propiedad en <code>Object.prototype</code>? lo busca en el <code>[[Prototype]]</code> de <code>Object.prototype</code> pero sorpresa! <strong><code>Object.prototype.__proto__</code> es <code>null</code></strong>. Eso significa que <strong>es el √∫ltimo objeto de la jerarqu√≠a de herencia</strong>, si llegado a √©ste punto Javascript no encuentra la propiedad que le pedimos devuelve <code>undefined</code>.</p>
<p>Esta jerarqu√≠a de prototipos suele llamarse <strong>cadena de prototipos</strong> del objeto. Por ejemplo, <code>Object.prototype</code> tiene la propiedad <code>.toString()</code>, entonces si volvemos a crear <code>perro</code> heredando de <code>animal</code>, su propiedad <code>.toString()</code> que ser√°? Javascript recorrer√° la jerarqu√≠a de prototipos de <code>perro</code> hasta encontrar <code>.toString()</code> que est√° en <code>Object.prototype</code>.</p>

<pre><code class="lang-js">var animal = {};
animal.estaVivo = function () {
  return true;
};

var perro = {};
perro.__proto__ = animal;
console.log(perro.toString === Object.prototype.toString);
</code></pre>
<p><a href="http://jsfiddle.net/amatiasq/4rVg4/" target="_blank">Pru√©bame</a></p>
<h3 id="como-modificar-una-propidad-inaccesible-">Como modificar una propidad inaccesible?</h3>
<p>Bien, la teor√≠a ha ido correctamente, pero como ya dijimos, <strong><code>__proto__</code> no es est√°ndar</strong>, y por lo tanto no podemos contar con que funcione en cualquier motor de Javascript, <strong>entonces c√≥mo se supone que vamos a implementar herencia en Javascript?</strong> Para ello Javascript provee de una funcionalidad un tanto dif√≠cil de entender as√≠ que intentaremos ir poco a poco.</p>
<p><strong>Toda funci√≥n, creada en Javascript tiene una propiedad llamada <code>.prototype</code> que no debe confundirse con <code>[[Prototype]]</code></strong>, el <code>[[Prototype]]</code> de las funciones apunta a <code>Function.prototype</code> que es un objeto que tiene funciones como <code>.call()</code>, <code>.apply()</code> y <code>.bind()</code>. No, en √©ste caso nos referimos a que todas las funciones tienen una propiedad llamada <code>prototype</code> que es un objeto vac√≠o. Y porqu√© se llama <code>prototype</code> si no tiene nada que ver con el <code>[[Prototype]]</code> de la funci√≥n? <strong>Porque los objetos que creemos llamando a √©sa funci√≥n con <code>new</code> tendr√°n su <code>[[Prototype]]</code> apuntando a la propiedad <code>prototype</code> de la funci√≥n:</strong></p>

<pre><code class="lang-js">function myFunct() {}
var obj = new myFunct();
console.log(obj.__proto__ === myFunct.prototype);
</code></pre>
<p><a href="http://jsfiddle.net/amatiasq/r2F8G/" target="_blank">Pru√©bame</a></p>
<p>Sorpresa! <strong>Hemos modificado la propiedad oculta <code>[[Prototype]]</code> de <code>obj</code>!</strong> Quiz√°s te preguntes porqu√© no se estandariza la propiedad accesible <code>__proto__</code>? Porque con el sistema de las funciones el lenguaje se asegura que <strong>s√≥lo podemos modificar la propiedad <code>[[Prototype]]</code> de objetos nuevos</strong>, no de existentes. De √©sta forma, en las implementaciones est√°ndar donde no podemos acceder a la propiedad <code>__proto__</code> no podemos modificar el prototipo de una funci√≥n o de <code>Object.prototype</code> ni podemos evitar que un objeto extienda de <code>Object.prototype</code>, poniendo su propiedad <code>__proto__</code> a <code>null</code> romper√≠amos √©sta regla del lenguaje.</p>
<p>Pero <strong>entonces <code>myFunct</code> es una clase? Podr√≠a decirse que si, pero no es una clase como las que estamos acostumbrados a ver, es una funci√≥n, es un objeto y es tangible</strong>, el hecho de crear nuevos objetos con <code>new</code> seguido de una funci√≥n es solo una sintaxis que se a√±adi√≥ a Javascript para parecerse a Java, lenguaje en plena expansi√≥n cuando Javascript fue dise√±ado. Ahora que entendemos que <code>myFunct.prototype</code> es igual al <code>[[Prototype]]</code> de los objetos que creemos con la funci√≥n podemos crear objetos que extiendan del mismo objeto:</p>

<pre><code class="lang-js">function myFunct() {}
myFunct.prototype = {
  name: &#39;Alice&#39;,
  lastname: &#39;Smith&#39;,
  fullname: function () {
    return this.name + &#39; &#39; + this.lastname;
  },
};

var instancia1 = new myFunct();
var instancia2 = new myFunct();

console.log(instancia1.fullname() + &#39;n&#39; + instancia2.fullname());
console.log(instancia1.__proto__ == instancia2.__proto__);
</code></pre>
<p><a href="http://jsfiddle.net/amatiasq/F2yQy/" target="_blank">Pru√©bame</a></p>
<p>E incluso podemos crear un objeto que extienda de una instancia de myFunct!</p>

<pre><code class="lang-js">instancia1.name = &#39;Bob&#39;;
function extenderInstancia1() {}
extenderInstancia1.prototype = instancia1;
var subInstancia = new extenderInstancia1();

var texto = &#39;Fullname: &#39; + subInstancia.fullname() + &#39;n&#39;;
texto += &#39;Es instancia de extenderInstancia1? &#39; + (subInstancia instanceof extenderInstancia1) + &#39;n&#39;;
texto += &#39;Es instancia de myFunct? &#39; + (subInstancia instanceof myFunct) + &#39;n&#39;;
texto += &#39;Es instancia de Object? &#39; + (subInstancia instanceof Object);

alert(texto);
</code></pre>
<p><a href="http://jsfiddle.net/amatiasq/Ggj6T/" target="_blank">Pru√©bame</a></p>
<h3 id="-extend-"><code>extend()</code></h3>
<p>Pero √©ste l√≠o de tener funciones que parecen clases pero no son clases exactamente y crean instancias y tener que crear funciones para extender es bastante confuso, por ello, los defensores de no mezclar la herencia por prototipos con √©stas falsas clases proponen usar la funci√≥n <code>extend</code>:</p>

<pre><code class="lang-js">function extend(proto) {
  function intermediario() {}
  intermediario.prototype = proto;
  return new intermediario();
}
</code></pre>
<p>Y con √©sta funci√≥n podemos extender objetos sin necesidad de crear funciones intermedias:</p>

<pre><code class="lang-js">var base = {
  name: &#39;Alice&#39;,
  lastname: &#39;Smith&#39;,
  fullname: function () {
    return this.name + &#39; &#39; + this.lastname;
  },
};

var instancia1 = extend(base);
var instancia2 = extend(base);

instancia1.name = &#39;Bob&#39;;
var subInstancia = extend(instancia1);
console.log(subInstancia.fullname());
</code></pre>
<p><a href="http://jsfiddle.net/amatiasq/WZFAH/" target="_blank">Pru√©bame</a></p>
<p>Como vemos, el c√≥digo queda bastante m√°s claro, es por √©sto que en la 5¬™ edici√≥n de ECMAScript (el est√°ndar en el que est√° basado Javascript), se decidi√≥ a√±adir <code>Object.create()</code> que <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/create">cumple la misma funcionalidad</a> que la funci√≥n <code>extend()</code> que hemos creado.</p>
<h3 id="resumen">Resumen</h3>
<p>Es un camino duro pasar de un lenguaje basado en clases a uno basado en prototipos, requiere mucha pr√°ctica, una mente abierta y muchas ganas de aprender. Pero las ganancias son grandes, incluso para desarrolladores que no necesiten tocar Javascript considero que aprender √©ste patr√≥n aporta ventajas porque <strong>entender ambos patrones en mente nos abre a nuevas ideas, nos ayuda a tener siempre presente que las cosas no tienen porque ser como estamos acostumbrados a que sean, y a buscar nuevas soluciones a nuevos problemas y por √∫ltimo pero no menos importante, nos mantiene activos</strong>. Espero que sea f√°cil seguir el post aunque se que ha crecido m√°s all√° de lo deseado, pido comprensi√≥n ya que escribir no es mi punto fuerte, pero para eso est√° la pr√°ctica, para mejorar ;)</p>
</div></div></body></html>